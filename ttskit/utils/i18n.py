"""Lightweight i18n helper for bot messages (fa/en).

Provides message templates and a small accessor.
"""

# Modern Python type hints

_MESSAGES: dict[str, dict[str, str | list[str]]] = {
    "fa": {
        "help": (
            "سلام! 👋 من ربات تبدیل متن به صدا هستم.\n"
            "استفاده: /voice <lang?:fa|en|ar:> <متن>\n\n"
            "مثال‌ها:\n"
            "/voice fa: سلام چطوری؟\n"
            "/voice en: Hello there\n"
            "/voice هذا اختبار\n\n"
            "زبان پیش‌فرض: {default_lang}\n"
            "حداکثر طول: {max_chars}"
        ),
        "empty_text": "لطفاً متن را وارد کنید. / Please provide some text.",
        "rate_limited": "لطفاً چند لحظه صبر کنید. / Please wait a moment.",
        "voice_ready": "ویس متن شما ✅ / Your voice is ready (lang: {lang_value})",
        "voice_cached": "ویس آماده ✅ (کش) / Cached (lang: {lang_value})",
        "tts_error": "خطا در تبدیل متن به صدا. لطفاً دوباره تلاش کنید. / Error generating voice, please try again.",
        "engine_not_found": "موتور صوتی برای زبان {error} یافت نشد. / Engine not found for language {error}",
        "audio_conversion_error": "خطا در تبدیل صدا: {error} / Audio conversion error: {error}",
        "ffmpeg_not_found": "FFmpeg نصب نیست. لطفاً آن را نصب کنید. / FFmpeg not found. Please install it.",
        "unexpected_error": "خطای غیرمنتظره: {error} / Unexpected error: {error}",
        "text_too_long": "متن خیلی طولانی است. حداکثر {max_length} کاراکتر مجاز است. / Text too long. Maximum {max_length} characters allowed.",
        "invalid_language": "زبان نامعتبر: {language} / Invalid language: {language}",
        "health_check": "بررسی وضعیت سیستم... / Checking system health...",
        "health_ok": "همه سیستم‌ها سالم هستند ✅ / All systems healthy ✅",
        "health_issues": "مشکلاتی یافت شد: {issues} / Issues found: {issues}",
        "cache_hit": "کش موفق ✅ / Cache hit ✅",
        "cache_miss": "کش ناموفق / Cache miss",
        "engine_fallback": "موتور {engine} خراب شد، از {fallback} استفاده می‌کنم / Engine {engine} failed, using {fallback}",
        "redis_connection_error": "خطا در اتصال به Redis / Redis connection error",
        "audio_processing_error": "خطا در پردازش صدا: {error} / Audio processing error: {error}",
        "rate_limit_exceeded": "حد مجاز درخواست‌ها تمام شد. لطفاً {wait_time} ثانیه صبر کنید / Rate limit exceeded. Please wait {wait_time} seconds",
        "invalid_engine": "موتور نامعتبر: {engine} / Invalid engine: {engine}",
        "engine_unavailable": "موتور {engine} در دسترس نیست / Engine {engine} is not available",
        "engine_priority_set": "✅ موتور '{engine}' در اولویت قرار گرفت. / Engine '{engine}' priority set.",
        "admin_help": "\n\nدستورات ادمین:\n/clearcache — پاکسازی کش\n/cachestats — آمار کش\n/reloadengines — بارگذاری مجدد موتور‌ها\n/resetstats — ریست آمار بات",
        "engines_list": "🔧 موتورهای موجود:\n{engines}",
        "no_engines": "(هیچ)",
        "stats_header": "📊 آمار:\nپیام‌ها: {messages}\nدرخواست‌ها: {requests}\nکَش هیت: {cache_hits} | میس: {cache_misses}\nمیانگین زمان: {avg_time:.2f}s",
        "bot_running": "✅ Bot is running",
        "languages_header": "🌐 Languages:\n{languages}",
        "voices_header": "🎵 صداها:{lang_info}{engine_info}",
        "no_voices": "(هیچ)",
        "access_denied": "⛔️ دسترسی کافی ندارید.",
        "cache_cleared": "✅ کش با موفقیت پاک شد.",
        "cache_clear_error": "❌ خطا در پاکسازی کش: {error}",
        "cache_stats_header": "💾 آمار کش:\nTotal Files: {total_files}\nTotal Size: {total_size:.2f} MB\nMax Cache Size: {max_cache_size}\nMax File Age: {max_file_age}s",
        "cache_stats_error": "❌ خطا در دریافت آمار کش: {error}",
        "engines_reloaded": "🔄 موتورهای TTS دوباره بارگذاری شدند.",
        "engines_reload_error": "❌ خطا در بارگذاری مجدد موتور‌ها: {error}",
        "stats_reset": "✅ آمار بات ریست شد.",
        "stats_reset_error": "❌ خطا در ریست آمار: {error}",
        "cache_cleanup_header": "🧹 پاکسازی کش:\nفایل‌های پاک شده: {cleaned_files}\nفضای آزاد شده: {cleaned_size:.2f} MB\nفایل‌های باقی‌مانده: {remaining_files}",
        "cache_export_header": "📤 صادرات کش:\nمسیر: {export_dir}\nتعداد فایل‌ها: {total_files}\nحجم کل: {total_size:.2f} MB",
        "cache_export_error": "❌ خطا در صادرات کش: {error}",
        "restarting": "🔄 در حال ری‌استارت...",
        "shutting_down": "⛔️ در حال خاموش کردن...",
        "stats_available": "📊 آمار بات در دسترس است.",
        "no_api_keys": "📝 هیچ کلید API موجود نیست. / No API keys available.",
        "monitoring_started": "🔄 شروع مانیتورینگ... / Starting monitoring...",
        "monitoring_cancelled": "❎ مانیتورینگ لغو شد / Monitoring cancelled",
        "api_key_deleted": "✅ کلید API برای کاربر {user_id} حذف شد. / API key for user {user_id} deleted.",
        "user_not_found": "❌ کاربر {user_id} یافت نشد. / User {user_id} not found.",
        "user_id_missing": "❌ user_id مشخص نشده. / user_id is missing.",
        "invalid_permissions": "❌ دسترسی‌های نامعتبر: {perms} / Invalid permissions: {perms}",
        "config_system": "⚙️ تنظیمات سیستم",
        "engine_change_error": "❌ خطا در تغییر موتور: {error}",
        "settings_change_error": "❌ خطا در تغییر تنظیمات: {error}",
        "cache_enabled": "✅ کش فعال شد.",
        "cache_disabled": "✅ کش غیرفعال شد.",
        "audio_enabled": "✅ پردازش صوت فعال شد.",
        "audio_disabled": "✅ پردازش صوت غیرفعال شد.",
        "unknown_setting": "⚠️ تنظیم ناشناخته.",
        "error_prefix": "❌ خطا: {error}",
        "text_callback": "📝 {data}",
        "voice_callback": "🎵 {data}",
        "processing": "در حال پردازش... ⏳",
        "voice_caption": "🎵 {text}",
        "general_error": "خطایی رخ داده است. لطفاً دوباره تلاش کنید.",
        "admin_panel_title": "🛠️ **پنل مدیریت TTSKit**\n\nیکی از گزینه‌ها را انتخاب کنید: / Choose an option:",
        "back_button": "🔙 بازگشت / Back",
        "system_stats": "📊 آمار سیستم / System Stats",
        "api_keys_management": "🔑 مدیریت API Keys / API Keys Management",
        "settings": "⚙️ تنظیمات / Settings",
        "cache_management": "🔄 مدیریت Cache / Cache Management",
        "test_engines": "🎤 تست Engines / Test Engines",
        "create_key_usage": "❌ **استفاده نادرست**\n\n✅ **درست:** `/create_key user_id:admin permissions:read,write,admin`\n📝 **مثال:** `/create_key user_id:test_user permissions:read,write`\n\n❌ **Incorrect usage**\n\n✅ **Correct:** `/create_key user_id:admin permissions:read,write,admin`\n📝 **Example:** `/create_key user_id:test_user permissions:read,write`",
        "api_key_created": "✅ **کلید API ایجاد شد**\n\n👤 **User ID:** `{user_id}`\n🔑 **API Key:** `{api_key}`\n🔐 **Permissions:** {permissions}\n\n⚠️ این کلید را در جای امن نگهداری کنید!\n\n✅ **API Key Created**\n\n👤 **User ID:** `{user_id}`\n🔑 **API Key:** `{api_key}`\n🔐 **Permissions:** {permissions}\n\n⚠️ Keep this key secure!",
        "api_keys_list_header": "🔑 **لیست کلیدهای API** / **API Keys List**",
        "debug_error": "❌ خطا در Debug: {error} / Debug error: {error}",
        "testing_all_engines": "🔄 در حال تست همه Engines... / Testing all engines...",
        "engine_test_results": "🎤 **Engine Test Results** / **نتایج تست موتورها**",
        "tts_commands": ["/tts", "/speak", "/voice", "/صدا", "/تکلم"],
        "admin_panel_welcome": "🛠️ **پنل مدیریت TTSKit**\n\nیکی از گزینه‌ها را انتخاب کنید: / Choose an option:",
        "user_management": "👥 مدیریت کاربران / User Management",
        "create_user_success": "✅ **کاربر ایجاد شد**\n\n👤 **User ID:** `{user_id}`\n📝 **نام:** {username}\n📧 **ایمیل:** {email}\n🔐 **نوع:** {user_type}\n📅 **تاریخ ایجاد:** {created_at}",
        "user_type_admin": "مدیر",
        "user_type_user": "کاربر عادی",
        "user_type_unknown": "نامشخص",
        "delete_user_confirm": "🗑️ **تأیید حذف کاربر**\n\n👤 **User ID:** `{user_id}`\n📝 **نام:** {username}\n📧 **ایمیل:** {email}\n🔐 **نوع:** {user_type}\n\n⚠️ آیا مطمئن هستید که می‌خواهید این کاربر را حذف کنید؟",
        "user_deleted": "✅ **کاربر حذف شد**\n\nUser `{user_id}`",
        "confirm_delete": "✅ تأیید حذف",
        "cancel_delete": "❌ لغو",
        "confirm_delete_user": "✅ تأیید حذف",
        "cancel_delete_user": "❌ لغو",
        "delete_cancelled": "❌ حذف لغو شد.",
        "user_delete_cancelled": "❌ حذف کاربر لغو شد.",
        "delete_api_key_confirm": "🗑️ **تأیید حذف کلید API**\n\n👤 **User ID:** `{user_id}`\n🔑 **API Key ID:** `{api_key_id}`\n🔐 **Permissions:** {permissions}\n\n⚠️ آیا مطمئن هستید که می‌خواهید این کلید را حذف کنید؟",
        "no_users_found": "📝 هیچ کاربری یافت نشد",
        "users_list_header": "👥 **لیست کاربران**",
        "user_name": "نام",
        "user_email": "ایمیل",
        "user_type": "نوع",
        "user_status": "وضعیت",
        "user_created": "ایجاد",
        "status_active": "فعال",
        "status_inactive": "غیرفعال",
        "api_keys_management_title": "🔑 **مدیریت API Keys**\n\nعملیات مورد نظر را انتخاب کنید:",
        "create_key_title": "➕ **Create API Key / ایجاد کلید جدید**\n\nSelect access level / نوع دسترسی را انتخاب کنید:\n\n👤 User: read / کاربر: فقط خواندن\n✍️ Writer: read, write / نویسنده: خواندن + نوشتن\n👑 Admin: read, write, admin / ادمین: همه دسترسی‌ها",
        "user_level": "👤 کاربر عادی",
        "writer_level": "✍️ نویسنده",
        "admin_level": "👑 ادمین",
        "delete_key_title": "🗑️ **حذف کلید API**\n\nکلید مورد نظر را انتخاب کنید:",
        "test_engines_title": "🎤 **تست Engines**\n\nEngine مورد نظر را برای تست انتخاب کنید:",
        "test_all_engines": "🎤 تست همه Engines",
        "test_edge": "🔍 تست Edge Engine",
        "test_piper": "🔍 تست Piper Engine",
        "test_gtts": "🔍 تست gTTS Engine",
        "testing_all_engines_progress": "🔄 در حال تست همه Engines...",
        "testing_all_engines_complete": "✅ تست همه Engines تکمیل شد!",
        "testing_engine_progress": "🔄 در حال تست {engine_name} Engine...",
        "testing_engine_complete": "✅ تست {engine_name} Engine تکمیل شد!",
        "create_new_key": "➕ ایجاد کلید جدید",
        "list_keys": "📋 لیست کلیدها",
        "delete_key": "🗑️ حذف کلید",
        "system_stats_detailed": """
📊 **آمار جامع سیستم**\n\n🔄 **درخواست‌ها:**\n• کل: {req_total}\n• موفق: {req_success}\n• ناموفق: {req_failed}\n• نرخ موفقیت: {req_success_rate:.1f}%\n• در دقیقه: {req_per_minute:.1f}\n\n🎤 **Engines:**\n{engines_lines}\n\n🗂️ **Cache:**\n• Hit Rate: {cache_hit_rate:.1f}%\n• Size: {cache_size_mb:.1f} MB\n• Evictions: {cache_evictions}\n\n⚡ **Performance:**\n• Avg Response: {perf_avg:.2f}s\n• P95 Response: {perf_p95:.2f}s\n• P99 Response: {perf_p99:.2f}s\n\n🖥️ **System:**\n• CPU: {cpu:.1f}%\n• Memory: {mem_mb:.1f} MB ({mem_percent:.1f}%)\n• Disk: {disk:.1f}%\n• Network: {net_mb:.1f} MB\n\n🎯 **Health Score:** {health:.1f}/100""",
        "health_check_report": """
🚨 **Health Check**\n\n{status_emoji} **وضعیت کلی:** {status_text} ({health_score:.1f}/100)\n\n📊 **جزئیات:**\n• CPU: {cpu:.1f}%\n• Memory: {mem_percent:.1f}%\n• Success Rate: {success_rate:.1f}%\n• Avg Response: {avg_response:.2f}s\n\n🎯 **توصیه‌ها:**\n{recommendations}""",
        "health_recommendations_ok": "• همه چیز عالی است! 🎉",
        "debug_info": """
🔍 **Debug Information**\n\n🖥️ **System:**\n• Platform: {platform}\n• Python: {python_version}\n• Architecture: {architecture}\n• Processor: {processor}\n• Hostname: {hostname}\n\n💾 **Memory:**\n• Total: {mem_total_gb:.1f} GB\n• Available: {mem_available_gb:.1f} GB\n• Used: {mem_used_gb:.1f} GB ({mem_percent:.1f}%)\n\n💿 **Disk:**\n• Total: {disk_total_gb:.1f} GB\n• Used: {disk_used_gb:.1f} GB ({disk_percent:.1f}%)\n• Free: {disk_free_gb:.1f} GB\n\n⚙️ **Settings:**\n• Cache Enabled: {cache_enabled}""",
        "monitoring_update": """
📊 **Real-time Monitoring** ({iteration}/10)\n\n🔄 **درخواست‌ها:**\n• کل: {req_total}\n• در دقیقه: {req_per_minute:.1f}\n• موفقیت: {success_rate:.1f}%\n\n🖥️ **System:**\n• CPU: {cpu:.1f}%\n• Memory: {mem_percent:.1f}%\n• Health: {health:.1f}/100""",
        "monitoring_complete": "✅ مانیتورینگ تکمیل شد.",
        "metrics_export_success": "✅ آمار با موفقیت در فایل `{file_path}` ذخیره شد.",
        "metrics_export_error": "❌ خطا در ذخیره آمار!",
        "engine_test_results_with_list": "🎤 **نتایج تست موتورها**\n\n{results}",
        "create_user_usage": """
❌ **استفاده نادرست**\n\n✅ **درست:** `/create_user user_id:test_user username:Test User email:test@example.com admin:false`\n📝 **مثال:** `/create_user user_id:new_user username:New User email:new@example.com admin:false`\n\n🔐 **پارامترها:**\n• `user_id` - شناسه کاربر (اجباری)\n• `username` - نام کاربر (اختیاری)\n• `email` - ایمیل (اختیاری)\n• `admin` - آیا مدیر است (true/false)""",
        "admin_keys_menu": "🔑 **مدیریت کلیدهای API**\n\nیکی از گزینه‌ها را انتخاب کنید:",
        "admin_test_menu": "🧪 **تست Engines**\n\nیکی از engines را برای تست انتخاب کنید:",
        "admin_back_menu": "🛠️ **پنل مدیریت TTSKit**\n\nیکی از گزینه‌ها را انتخاب کنید:",
        "confirm_clear_cache_prompt": "🗑️ **پاک کردن Cache**\n\nآیا مطمئن هستید که می‌خواهید Cache را پاک کنید؟\nاین عمل غیرقابل برگشت است.",
        "clear_cache_cancelled": "❌ پاک کردن Cache لغو شد.",
        "restart_complete": "✅ سیستم ریستارت شد.",
        "admin_settings_details": """
🔧 **تنظیمات سیستم**\n\n🔧 **API:**\n• Rate Limit: {api_rate_limit} requests/minute\n• Max Text Length: {max_text_length} characters\n• Cache TTL: {cache_ttl} seconds\n\n🎤 **TTS:**\n• Default Engine: {default_engine}\n• Default Language: {default_language}\n• Audio Format: {audio_format}\n\n🗂️ **Cache:**\n• Enabled: {cache_enabled}\n• Type: {cache_type}\n• Max Size: {cache_max_size} MB""",
        "cache_management_status": """
🔄 **مدیریت Cache**\n\n📊 **وضعیت فعلی:**\n• Hit Rate: {hit_rate:.1f}%\n• Total Hits: {total_hits}\n• Total Misses: {total_misses}\n• Size: {size_mb:.1f} MB\n• Evictions: {evictions}""",
    },
    "en": {
        "help": (
            "Hi! 👋 I'm a text-to-speech bot.\n"
            "Usage: /voice <lang?:fa|en|ar:> <text>\n\n"
            "Examples:\n"
            "/voice fa: سلام چطوری؟\n"
            "/voice en: Hello there\n"
            "/voice هذا اختبار\n\n"
            "Default language: {default_lang}\n"
            "Max length: {max_chars}"
        ),
        "empty_text": "Please provide some text.",
        "rate_limited": "Please wait a moment.",
        "voice_ready": "Your voice is ready ✅ (lang: {lang_value})",
        "voice_cached": "Cached ✅ (lang: {lang_value})",
        "tts_error": "Error generating voice, please try again.",
        "engine_not_found": "Engine not found for language {error}",
        "audio_conversion_error": "Audio conversion error: {error}",
        "ffmpeg_not_found": "FFmpeg not found. Please install it.",
        "unexpected_error": "Unexpected error: {error}",
        "text_too_long": "Text too long. Maximum {max_length} characters allowed.",
        "invalid_language": "Invalid language: {language}",
        "health_check": "Checking system health...",
        "health_ok": "All systems healthy ✅",
        "health_issues": "Issues found: {issues}",
        "cache_hit": "Cache hit ✅",
        "cache_miss": "Cache miss",
        "engine_fallback": "Engine {engine} failed, using {fallback}",
        "redis_connection_error": "Redis connection error",
        "audio_processing_error": "Audio processing error: {error}",
        "rate_limit_exceeded": "Rate limit exceeded. Please wait {wait_time} seconds",
        "invalid_engine": "Invalid engine: {engine}",
        "engine_unavailable": "Engine {engine} is not available",
        "engine_priority_set": "✅ Engine '{engine}' priority set.",
        "admin_help": "\n\nAdmin Commands:\n/clearcache — Clear cache\n/cachestats — Cache stats\n/reloadengines — Reload engines\n/resetstats — Reset bot stats",
        "engines_list": "🔧 Available engines:\n{engines}",
        "no_engines": "(none)",
        "stats_header": "📊 Stats:\nMessages: {messages}\nRequests: {requests}\nCache hits: {cache_hits} | misses: {cache_misses}\nAvg time: {avg_time:.2f}s",
        "bot_running": "✅ Bot is running",
        "languages_header": "🌐 Languages:\n{languages}",
        "voices_header": "🎵 Voices:{lang_info}{engine_info}",
        "no_voices": "(none)",
        "access_denied": "⛔️ Insufficient permissions.",
        "cache_cleared": "✅ Cache cleared successfully.",
        "cache_clear_error": "❌ Error clearing cache: {error}",
        "cache_stats_header": "💾 Cache stats:\nTotal Files: {total_files}\nTotal Size: {total_size:.2f} MB\nMax Cache Size: {max_cache_size}\nMax File Age: {max_file_age}s",
        "cache_stats_error": "❌ Error getting cache stats: {error}",
        "engines_reloaded": "🔄 TTS engines reloaded.",
        "engines_reload_error": "❌ Error reloading engines: {error}",
        "stats_reset": "✅ Bot stats reset.",
        "stats_reset_error": "❌ Error resetting stats: {error}",
        "cache_cleanup_header": "🧹 Cache cleanup:\nFiles cleaned: {cleaned_files}\nSpace freed: {cleaned_size:.2f} MB\nRemaining files: {remaining_files}",
        "cache_export_header": "📤 Cache export:\nPath: {export_dir}\nFiles: {total_files}\nTotal size: {total_size:.2f} MB",
        "cache_export_error": "❌ Error exporting cache: {error}",
        "restarting": "🔄 Restarting...",
        "shutting_down": "⛔️ Shutting down...",
        "stats_available": "📊 Bot stats available.",
        "no_api_keys": "📝 No API keys available.",
        "monitoring_started": "🔄 Starting monitoring...",
        "monitoring_cancelled": "❎ Monitoring cancelled",
        "api_key_deleted": "✅ API key for user {user_id} deleted.",
        "user_not_found": "❌ User {user_id} not found.",
        "user_id_missing": "❌ user_id is missing.",
        "invalid_permissions": "❌ Invalid permissions: {perms}",
        "config_system": "⚙️ System settings",
        "engine_change_error": "❌ Error changing engine: {error}",
        "settings_change_error": "❌ Error changing settings: {error}",
        "cache_enabled": "✅ Cache enabled.",
        "cache_disabled": "✅ Cache disabled.",
        "audio_enabled": "✅ Audio processing enabled.",
        "audio_disabled": "✅ Audio processing disabled.",
        "unknown_setting": "⚠️ Unknown setting.",
        "error_prefix": "❌ Error: {error}",
        "text_callback": "📝 {data}",
        "voice_callback": "🎵 {data}",
        "processing": "Processing... ⏳",
        "voice_caption": "🎵 {text}",
        "general_error": "An error occurred. Please try again.",
        "admin_panel_title": "🛠️ **TTSKit Admin Panel**\n\nChoose an option:",
        "back_button": "🔙 Back",
        "system_stats": "📊 System Stats",
        "api_keys_management": "🔑 API Keys Management",
        "settings": "⚙️ Settings",
        "cache_management": "🔄 Cache Management",
        "test_engines": "🎤 Test Engines",
        "create_key_usage": "❌ **Incorrect usage**\n\n✅ **Correct:** `/create_key user_id:admin permissions:read,write,admin`\n📝 **Example:** `/create_key user_id:test_user permissions:read,write`",
        "api_key_created": "✅ **API Key Created**\n\n👤 **User ID:** `{user_id}`\n🔑 **API Key:** `{api_key}`\n🔐 **Permissions:** {permissions}\n\n⚠️ Keep this key secure!",
        "api_keys_list_header": "🔑 **API Keys List**",
        "debug_error": "❌ Debug error: {error}",
        "testing_all_engines": "🔄 Testing all engines...",
        "engine_test_results": "🎤 **Engine Test Results**",
        "tts_commands": ["/tts", "/speak", "/voice", "/صدا", "/تکلم"],
        "admin_panel_welcome": "🛠️ **TTSKit Admin Panel**\n\nChoose an option:",
        "user_management": "👥 User Management",
        "create_user_success": "✅ **User Created**\n\n👤 **User ID:** `{user_id}`\n📝 **Name:** {username}\n📧 **Email:** {email}\n🔐 **Type:** {user_type}\n📅 **Created:** {created_at}",
        "user_type_admin": "Admin",
        "user_type_user": "Regular User",
        "user_type_unknown": "Unknown",
        "delete_user_confirm": "🗑️ **Confirm User Deletion**\n\n👤 **User ID:** `{user_id}`\n📝 **Name:** {username}\n📧 **Email:** {email}\n🔐 **Type:** {user_type}\n\n⚠️ Are you sure you want to delete this user?",
        "user_deleted": "✅ **User Deleted**\n\nUser `{user_id}`",
        "confirm_delete": "✅ Confirm Delete",
        "cancel_delete": "❌ Cancel",
        "confirm_delete_user": "✅ Confirm Delete",
        "cancel_delete_user": "❌ Cancel",
        "delete_cancelled": "❌ Deletion cancelled.",
        "user_delete_cancelled": "❌ User deletion cancelled.",
        "delete_api_key_confirm": "🗑️ **Confirm API Key Deletion**\n\n👤 **User ID:** `{user_id}`\n🔑 **API Key ID:** `{api_key_id}`\n🔐 **Permissions:** {permissions}\n\n⚠️ Are you sure you want to delete this API key?",
        "no_users_found": "📝 No users found",
        "users_list_header": "👥 **Users List**",
        "user_name": "Name",
        "user_email": "Email",
        "user_type": "Type",
        "user_status": "Status",
        "user_created": "Created",
        "status_active": "Active",
        "status_inactive": "Inactive",
        "api_keys_management_title": "🔑 **API Keys Management**\n\nSelect the desired operation:",
        "create_key_title": "➕ **Create API Key**\n\nSelect access level:\n\n👤 User: read only\n✍️ Writer: read + write\n👑 Admin: all permissions",
        "user_level": "👤 Regular User",
        "writer_level": "✍️ Writer",
        "admin_level": "👑 Admin",
        "delete_key_title": "🗑️ **Delete API Key**\n\nSelect the key to delete:",
        "test_engines_title": "🎤 **Test Engines**\n\nSelect the engine to test:",
        "test_all_engines": "🎤 Test All Engines",
        "test_edge": "🔍 Test Edge Engine",
        "test_piper": "🔍 Test Piper Engine",
        "test_gtts": "🔍 Test gTTS Engine",
        "testing_all_engines_progress": "🔄 Testing all engines...",
        "testing_all_engines_complete": "✅ All engines testing completed!",
        "testing_engine_progress": "🔄 Testing {engine_name} engine...",
        "testing_engine_complete": "✅ {engine_name} engine testing completed!",
        "create_new_key": "➕ Create New Key",
        "list_keys": "📋 List Keys",
        "delete_key": "🗑️ Delete Key",
        "system_stats_detailed": """
📊 **Comprehensive System Stats**\n\n🔄 **Requests:**\n• Total: {req_total}\n• Successful: {req_success}\n• Failed: {req_failed}\n• Success Rate: {req_success_rate:.1f}%\n• Per Minute: {req_per_minute:.1f}\n\n🎤 **Engines:**\n{engines_lines}\n\n🗂️ **Cache:**\n• Hit Rate: {cache_hit_rate:.1f}%\n• Size: {cache_size_mb:.1f} MB\n• Evictions: {cache_evictions}\n\n⚡ **Performance:**\n• Avg Response: {perf_avg:.2f}s\n• P95 Response: {perf_p95:.2f}s\n• P99 Response: {perf_p99:.2f}s\n\n🖥️ **System:**\n• CPU: {cpu:.1f}%\n• Memory: {mem_mb:.1f} MB ({mem_percent:.1f}%)\n• Disk: {disk:.1f}%\n• Network: {net_mb:.1f} MB\n\n🎯 **Health Score:** {health:.1f}/100""",
        "health_check_report": """
🚨 **Health Check**\n\n{status_emoji} **Overall:** {status_text} ({health_score:.1f}/100)\n\n📊 **Details:**\n• CPU: {cpu:.1f}%\n• Memory: {mem_percent:.1f}%\n• Success Rate: {success_rate:.1f}%\n• Avg Response: {avg_response:.2f}s\n\n🎯 **Recommendations:**\n{recommendations}""",
        "health_recommendations_ok": "• Everything looks great! 🎉",
        "debug_info": """
🔍 **Debug Information**\n\n🖥️ **System:**\n• Platform: {platform}\n• Python: {python_version}\n• Architecture: {architecture}\n• Processor: {processor}\n• Hostname: {hostname}\n\n💾 **Memory:**\n• Total: {mem_total_gb:.1f} GB\n• Available: {mem_available_gb:.1f} GB\n• Used: {mem_used_gb:.1f} GB ({mem_percent:.1f}%)\n\n💿 **Disk:**\n• Total: {disk_total_gb:.1f} GB\n• Used: {disk_used_gb:.1f} GB ({disk_percent:.1f}%)\n• Free: {disk_free_gb:.1f} GB\n\n⚙️ **Settings:**\n• Cache Enabled: {cache_enabled}""",
        "monitoring_update": """
📊 **Real-time Monitoring** ({iteration}/10)\n\n🔄 **Requests:**\n• Total: {req_total}\n• Per Minute: {req_per_minute:.1f}\n• Success: {success_rate:.1f}%\n\n🖥️ **System:**\n• CPU: {cpu:.1f}%\n• Memory: {mem_percent:.1f}%\n• Health: {health:.1f}/100""",
        "monitoring_complete": "✅ Monitoring completed.",
        "metrics_export_success": "✅ Metrics saved to `{file_path}`.",
        "metrics_export_error": "❌ Error saving metrics!",
        "engine_test_results_with_list": "🎤 **Engine Test Results**\n\n{results}",
        "create_user_usage": """
❌ **Incorrect usage**\n\n✅ **Correct:** `/create_user user_id:test_user username:Test User email:test@example.com admin:false`\n📝 **Example:** `/create_user user_id:new_user username:New User email:new@example.com admin:false`\n\n🔐 **Params:**\n• `user_id` - required\n• `username` - optional\n• `email` - optional\n• `admin` - true/false""",
        "admin_keys_menu": "🔑 **API Keys Management**\n\nChoose an option:",
        "admin_test_menu": "🧪 **Test Engines**\n\nChoose an engine to test:",
        "admin_back_menu": "🛠️ **TTSKit Admin Panel**\n\nChoose an option:",
        "confirm_clear_cache_prompt": "🗑️ **Clear Cache**\n\nAre you sure you want to clear the cache?\nThis action is irreversible.",
        "clear_cache_cancelled": "❌ Cache clearing cancelled.",
        "restart_complete": "✅ System restarted.",
        "admin_settings_details": """
🔧 **System Settings**\n\n🔧 **API:**\n• Rate Limit: {api_rate_limit} requests/minute\n• Max Text Length: {max_text_length} characters\n• Cache TTL: {cache_ttl} seconds\n\n🎤 **TTS:**\n• Default Engine: {default_engine}\n• Default Language: {default_language}\n• Audio Format: {audio_format}\n\n🗂️ **Cache:**\n• Enabled: {cache_enabled}\n• Type: {cache_type}\n• Max Size: {cache_max_size} MB""",
        "cache_management_status": """
🔄 **Cache Management**\n\n📊 **Current Status:**\n• Hit Rate: {hit_rate:.1f}%\n• Total Hits: {total_hits}\n• Total Misses: {total_misses}\n• Size: {size_mb:.1f} MB\n• Evictions: {evictions}""",
    },
    "ar": {
        "help": (
            "مرحبًا! 👋 أنا بوت تحويل النص إلى كلام.\n"
            "الاستخدام: /voice <lang?:fa|en|ar:> <النص>\n\n"
            "أمثلة:\n"
            "/voice fa: سلام چطوری؟\n"
            "/voice en: Hello there\n"
            "/voice هذا اختبار\n\n"
            "اللغة الافتراضية: {default_lang}\n"
            "الحد الأقصى للطول: {max_chars}"
        ),
        "empty_text": "يرجى إدخال نص.",
        "rate_limited": "يرجى الانتظار قليلًا.",
        "voice_ready": "الصوت جاهز ✅ (اللغة: {lang_value})",
        "voice_cached": "مخزن مؤقتًا ✅ (اللغة: {lang_value})",
        "tts_error": "حدث خطأ أثناء إنشاء الصوت، يرجى المحاولة مرة أخرى.",
        "engine_not_found": "المحرك غير متوفر للغة {error}",
        "audio_conversion_error": "خطأ في تحويل الصوت: {error}",
        "ffmpeg_not_found": "FFmpeg غير مثبت. يرجى تثبيته.",
        "unexpected_error": "خطأ غير متوقع: {error}",
        "text_too_long": "النص طويل جدًا. الحد الأقصى {max_length} حرفًا.",
        "invalid_language": "لغة غير صالحة: {language}",
        "health_check": "جارٍ التحقق من صحة النظام...",
        "health_ok": "جميع الأنظمة سليمة ✅",
        "health_issues": "تم العثور على مشكلات: {issues}",
        "cache_hit": "نجح التخزين المؤقت ✅",
        "cache_miss": "فشل التخزين المؤقت",
        "engine_fallback": "فشل المحرك {engine}، استخدام {fallback}",
        "redis_connection_error": "خطأ في الاتصال بـ Redis",
        "audio_processing_error": "خطأ في معالجة الصوت: {error}",
        "rate_limit_exceeded": "تم تجاوز الحد المسموح. يرجى الانتظار {wait_time} ثانية",
        "invalid_engine": "محرك غير صالح: {engine}",
        "engine_unavailable": "المحرك {engine} غير متوفر",
        "engine_priority_set": "✅ تم تعيين أولوية المحرك '{engine}'. / Engine '{engine}' priority set.",
        "admin_help": "\n\nأوامر الإدارة:\n/clearcache — مسح التخزين المؤقت\n/cachestats — إحصائيات التخزين المؤقت\n/reloadengines — إعادة تحميل المحركات\n/resetstats — إعادة تعيين إحصائيات البوت",
        "engines_list": "🔧 المحركات المتاحة:\n{engines}",
        "no_engines": "(لا يوجد)",
        "stats_header": "📊 الإحصائيات:\nالرسائل: {messages}\nالطلبات: {requests}\nنجح التخزين المؤقت: {cache_hits} | فشل: {cache_misses}\nمتوسط الوقت: {avg_time:.2f}ث",
        "bot_running": "✅ البوت يعمل",
        "languages_header": "🌐 اللغات:\n{languages}",
        "voices_header": "🎵 الأصوات:{lang_info}{engine_info}",
        "no_voices": "(لا يوجد)",
        "access_denied": "⛔️ صلاحيات غير كافية.",
        "cache_cleared": "✅ تم مسح التخزين المؤقت بنجاح.",
        "cache_clear_error": "❌ خطأ في مسح التخزين المؤقت: {error}",
        "cache_stats_header": "💾 إحصائيات التخزين المؤقت:\nإجمالي الملفات: {total_files}\nإجمالي الحجم: {total_size:.2f} ميجابايت\nالحد الأقصى للتخزين المؤقت: {max_cache_size}\nالعمر الأقصى للملف: {max_file_age}ث",
        "cache_stats_error": "❌ خطأ في الحصول على إحصائيات التخزين المؤقت: {error}",
        "engines_reloaded": "🔄 تم إعادة تحميل محركات TTS.",
        "engines_reload_error": "❌ خطأ في إعادة تحميل المحركات: {error}",
        "stats_reset": "✅ تم إعادة تعيين إحصائيات البوت.",
        "stats_reset_error": "❌ خطأ في إعادة تعيين الإحصائيات: {error}",
        "cache_cleanup_header": "🧹 تنظيف التخزين المؤقت:\nالملفات المنظفة: {cleaned_files}\nالمساحة المحررة: {cleaned_size:.2f} ميجابايت\nالملفات المتبقية: {remaining_files}",
        "cache_export_header": "📤 تصدير التخزين المؤقت:\nالمسار: {export_dir}\nعدد الملفات: {total_files}\nالحجم الإجمالي: {total_size:.2f} ميجابايت",
        "cache_export_error": "❌ خطأ في تصدير التخزين المؤقت: {error}",
        "restarting": "🔄 جاري إعادة التشغيل...",
        "shutting_down": "⛔️ جاري الإغلاق...",
        "stats_available": "📊 إحصائيات البوت متاحة.",
        "no_api_keys": "📝 لا توجد مفاتيح API.",
        "monitoring_started": "🔄 بدء المراقبة...",
        "monitoring_cancelled": "❎ تم إلغاء المراقبة",
        "api_key_deleted": "✅ تم حذف مفتاح API للمستخدم {user_id}.",
        "user_not_found": "❌ المستخدم {user_id} غير موجود.",
        "user_id_missing": "❌ user_id غير موجود.",
        "invalid_permissions": "❌ صلاحيات غير صالحة: {perms}",
        "config_system": "⚙️ إعدادات النظام",
        "engine_change_error": "❌ خطأ في تغيير المحرك: {error}",
        "settings_change_error": "❌ خطأ في تغيير الإعدادات: {error}",
        "cache_enabled": "✅ تم تفعيل التخزين المؤقت.",
        "cache_disabled": "✅ تم إلغاء التخزين المؤقت.",
        "audio_enabled": "✅ تم تفعيل معالجة الصوت.",
        "audio_disabled": "✅ تم إلغاء معالجة الصوت.",
        "unknown_setting": "⚠️ إعداد غير معروف.",
        "error_prefix": "❌ خطأ: {error}",
        "text_callback": "📝 {data}",
        "voice_callback": "🎵 {data}",
        "processing": "جاري المعالجة... ⏳",
        "voice_caption": "🎵 {text}",
        "general_error": "حدث خطأ. يرجى المحاولة مرة أخرى.",
        "admin_panel_title": "🛠️ **لوحة إدارة TTSKit**\n\nاختر خيارًا:",
        "back_button": "🔙 عودة",
        "system_stats": "📊 إحصائيات النظام",
        "api_keys_management": "🔑 إدارة مفاتيح API",
        "settings": "⚙️ الإعدادات",
        "cache_management": "🔄 إدارة التخزين المؤقت",
        "test_engines": "🎤 اختبار المحركات",
        "create_key_usage": "❌ **استخدام غير صحيح**\n\n✅ **صحيح:** `/create_key user_id:admin permissions:read,write,admin`\n📝 **مثال:** `/create_key user_id:test_user permissions:read,write`",
        "api_key_created": "✅ **تم إنشاء مفتاح API**\n\n👤 **معرف المستخدم:** `{user_id}`\n🔑 **مفتاح API:** `{api_key}`\n🔐 **الصلاحيات:** {permissions}\n\n⚠️ احتفظ بهذا المفتاح في مكان آمن!",
        "api_keys_list_header": "🔑 **قائمة مفاتيح API**",
        "debug_error": "❌ خطأ في Debug: {error}",
        "testing_all_engines": "🔄 جاري اختبار جميع المحركات...",
        "engine_test_results": "🎤 **نتائج اختبار المحركات**",
        "tts_commands": ["/tts", "/speak", "/voice", "/صدا", "/تکلم"],
        "admin_panel_welcome": "🛠️ **لوحة إدارة TTSKit**\n\nاختر خيارًا:",
        "user_management": "👥 إدارة المستخدمين",
        "create_user_success": "✅ **تم إنشاء المستخدم**\n\n👤 **معرف المستخدم:** `{user_id}`\n📝 **الاسم:** {username}\n📧 **البريد الإلكتروني:** {email}\n🔐 **النوع:** {user_type}\n📅 **تاريخ الإنشاء:** {created_at}",
        "user_type_admin": "مدير",
        "user_type_user": "مستخدم عادي",
        "user_type_unknown": "غير معروف",
        "delete_user_confirm": "🗑️ **تأكيد حذف المستخدم**\n\n👤 **معرف المستخدم:** `{user_id}`\n📝 **الاسم:** {username}\n📧 **البريد الإلكتروني:** {email}\n🔐 **النوع:** {user_type}\n\n⚠️ هل أنت متأكد من أنك تريد حذف هذا المستخدم؟",
        "user_deleted": "✅ **تم حذف المستخدم**\n\nالمستخدم `{user_id}`",
        "confirm_delete": "✅ تأكيد الحذف",
        "cancel_delete": "❌ إلغاء",
        "confirm_delete_user": "✅ تأكيد الحذف",
        "cancel_delete_user": "❌ إلغاء",
        "delete_cancelled": "❌ تم إلغاء الحذف.",
        "user_delete_cancelled": "❌ تم إلغاء حذف المستخدم.",
        "delete_api_key_confirm": "🗑️ **تأكيد حذف مفتاح API**\n\n👤 **معرف المستخدم:** `{user_id}`\n🔑 **معرف مفتاح API:** `{api_key_id}`\n🔐 **الصلاحيات:** {permissions}\n\n⚠️ هل أنت متأكد من أنك تريد حذف هذا المفتاح؟",
        "no_users_found": "📝 لم يتم العثور على مستخدمين",
        "users_list_header": "👥 **قائمة المستخدمين**",
        "user_name": "الاسم",
        "user_email": "البريد الإلكتروني",
        "user_type": "النوع",
        "user_status": "الحالة",
        "user_created": "تاريخ الإنشاء",
        "status_active": "نشط",
        "status_inactive": "غير نشط",
        "api_keys_management_title": "🔑 **إدارة مفاتيح API**\n\nاختر العملية المطلوبة:",
        "create_key_title": "➕ **إنشاء مفتاح API**\n\nاختر مستوى الوصول:\n\n👤 مستخدم: قراءة فقط\n✍️ كاتب: قراءة + كتابة\n👑 مدير: جميع الصلاحيات",
        "user_level": "👤 مستخدم عادي",
        "writer_level": "✍️ كاتب",
        "admin_level": "👑 مدير",
        "delete_key_title": "🗑️ **حذف مفتاح API**\n\nاختر المفتاح المراد حذفه:",
        "test_engines_title": "🎤 **اختبار المحركات**\n\nاختر المحرك المراد اختباره:",
        "test_all_engines": "🎤 اختبار جميع المحركات",
        "test_edge": "🔍 اختبار محرك Edge",
        "test_piper": "🔍 اختبار محرك Piper",
        "test_gtts": "🔍 اختبار محرك gTTS",
        "testing_all_engines_progress": "🔄 جاري اختبار جميع المحركات...",
        "testing_all_engines_complete": "✅ تم اختبار جميع المحركات!",
        "testing_engine_progress": "🔄 جاري اختبار محرك {engine_name}...",
        "testing_engine_complete": "✅ تم اختبار محرك {engine_name}!",
        "create_new_key": "➕ إنشاء مفتاح جديد",
        "list_keys": "📋 قائمة المفاتيح",
        "delete_key": "🗑️ حذف المفتاح",
        "system_stats_detailed": """
📊 **إحصائيات النظام الشاملة**\n\n🔄 **الطلبات:**\n• الإجمالي: {req_total}\n• الناجحة: {req_success}\n• الفاشلة: {req_failed}\n• نسبة النجاح: {req_success_rate:.1f}%\n• في الدقيقة: {req_per_minute:.1f}\n\n🎤 **المحركات:**\n{engines_lines}\n\n🗂️ **التخزين المؤقت:**\n• معدل النجاح: {cache_hit_rate:.1f}%\n• الحجم: {cache_size_mb:.1f} MB\n• عمليات الإزالة: {cache_evictions}\n\n⚡ **الأداء:**\n• متوسط الاستجابة: {perf_avg:.2f}s\n• P95: {perf_p95:.2f}s\n• P99: {perf_p99:.2f}s\n\n🖥️ **النظام:**\n• CPU: {cpu:.1f}%\n• الذاكرة: {mem_mb:.1f} MB ({mem_percent:.1f}%)\n• القرص: {disk:.1f}%\n• الشبكة: {net_mb:.1f} MB\n\n🎯 **درجة الصحة:** {health:.1f}/100""",
        "health_check_report": """
🚨 **فحص الصحة**\n\n{status_emoji} **الحالة العامة:** {status_text} ({health_score:.1f}/100)\n\n📊 **التفاصيل:**\n• CPU: {cpu:.1f}%\n• الذاكرة: {mem_percent:.1f}%\n• نسبة النجاح: {success_rate:.1f}%\n• متوسط الاستجابة: {avg_response:.2f}s\n\n🎯 **التوصيات:**\n{recommendations}""",
        "health_recommendations_ok": "• كل شيء ممتاز! 🎉",
        "debug_info": """
🔍 **معلومات التصحيح**\n\n🖥️ **النظام:**\n• المنصة: {platform}\n• بايثون: {python_version}\n• المعمارية: {architecture}\n• المعالج: {processor}\n• المضيف: {hostname}\n\n💾 **الذاكرة:**\n• الإجمالي: {mem_total_gb:.1f} GB\n• المتاح: {mem_available_gb:.1f} GB\n• المستخدم: {mem_used_gb:.1f} GB ({mem_percent:.1f}%)\n\n💿 **القرص:**\n• الإجمالي: {disk_total_gb:.1f} GB\n• المستخدم: {disk_used_gb:.1f} GB ({disk_percent:.1f}%)\n• الحر: {disk_free_gb:.1f} GB\n\n⚙️ **الإعدادات:**\n• التخزين المؤقت مفعل: {cache_enabled}""",
        "monitoring_update": """
📊 **مراقبة لحظية** ({iteration}/10)\n\n🔄 **الطلبات:**\n• الإجمالي: {req_total}\n• في الدقيقة: {req_per_minute:.1f}\n• النجاح: {success_rate:.1f}%\n\n🖥️ **النظام:**\n• CPU: {cpu:.1f}%\n• الذاكرة: {mem_percent:.1f}%\n• الصحة: {health:.1f}/100""",
        "monitoring_complete": "✅ اكتملت المراقبة.",
        "metrics_export_success": "✅ تم حفظ الإحصائيات في `{file_path}`.",
        "metrics_export_error": "❌ خطأ في حفظ الإحصائيات!",
        "engine_test_results_with_list": "🎤 **نتائج اختبار المحركات**\n\n{results}",
        "create_user_usage": """
❌ **استخدام غير صحيح**\n\n✅ **صحيح:** `/create_user user_id:test_user username:Test User email:test@example.com admin:false`\n📝 **مثال:** `/create_user user_id:new_user username:New User email:new@example.com admin:false`\n\n🔐 **المعلمات:**\n• `user_id` - مطلوب\n• `username` - اختياري\n• `email` - اختياري\n• `admin` - true/false""",
        "admin_keys_menu": "🔑 **إدارة مفاتيح API**\n\nاختر خيارًا:",
        "admin_test_menu": "🧪 **اختبار المحركات**\n\nاختر محركًا للاختبار:",
        "admin_back_menu": "🛠️ **لوحة إدارة TTSKit**\n\nاختر خيارًا:",
        "confirm_clear_cache_prompt": "🗑️ **مسح التخزين المؤقت**\n\nهل أنت متأكد أنك تريد مسح الكاش؟\nهذا الإجراء لا يمكن التراجع عنه.",
        "clear_cache_cancelled": "❌ تم إلغاء مسح الكاش.",
        "restart_complete": "✅ تم إعادة تشغيل النظام.",
        "admin_settings_details": """
🔧 **إعدادات النظام**\n\n🔧 **API:**\n• الحد: {api_rate_limit} طلب/دقيقة\n• الحد الأقصى للنص: {max_text_length} حرفًا\n• TTL الكاش: {cache_ttl} ثانية\n\n🎤 **TTS:**\n• المحرك الافتراضي: {default_engine}\n• اللغة الافتراضية: {default_language}\n• صيغة الصوت: {audio_format}\n\n🗂️ **الكاش:**\n• مفعّل: {cache_enabled}\n• النوع: {cache_type}\n• الحجم الأقصى: {cache_max_size} MB""",
        "cache_management_status": """
🔄 **إدارة الكاش**\n\n📊 **الحالة الحالية:**\n• معدل النجاح: {hit_rate:.1f}%\n• إجمالي النجاح: {total_hits}\n• إجمالي الفشل: {total_misses}\n• الحجم: {size_mb:.1f} MB\n• عمليات الإزالة: {evictions}""",
    },
}


def _normalize_lang(lang: str | None) -> str:
    if not lang:
        return "fa"
    lang = lang.lower()
    if lang.startswith("fa"):
        return "fa"
    if lang.startswith("en"):
        return "en"
    if lang.startswith("ar"):
        return "ar"
    return "fa"


def get_tts_commands() -> list[str]:
    """Get TTS commands list."""
    commands = _MESSAGES["fa"]["tts_commands"]
    if isinstance(commands, list):
        return commands
    return []


def t(key: str, *, lang: str | None = None, **kwargs: object) -> str:
    """Return localized text for key.

    Args:
        key: Message key.
        lang: Preferred language (e.g., 'fa', 'en').
        **kwargs: Format parameters.

    Returns:
        Localized formatted string.
    """
    code = _normalize_lang(lang)
    bundle = _MESSAGES.get(code, _MESSAGES["fa"])  # fallback fa
    template = bundle.get(key, _MESSAGES["fa"].get(key, ""))
    try:
        return template.format(**kwargs)
    except Exception:
        return template
